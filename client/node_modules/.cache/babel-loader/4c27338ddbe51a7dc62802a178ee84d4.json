{"ast":null,"code":"import _regeneratorRuntime from\"/Users/austinhague/Full_Stack_UofR/Projects/shop-shop-till-you-drop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/austinhague/Full_Stack_UofR/Projects/shop-shop-till-you-drop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/austinhague/Full_Stack_UofR/Projects/shop-shop-till-you-drop/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect}from'react';import{useMutation}from'@apollo/client';import Jumbotron from'../components/Jumbotron';import{ADD_ORDER}from'../utils/mutations';import{idbPromise}from'../utils/helpers';function Success(){var _useMutation=useMutation(ADD_ORDER),_useMutation2=_slicedToArray(_useMutation,1),addOrder=_useMutation2[0];useEffect(function(){function saveOrder(){return _saveOrder.apply(this,arguments);}function _saveOrder(){_saveOrder=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var cart,products,_yield$addOrder,data,productData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return idbPromise('cart','get');case 2:cart=_context.sent;products=cart.map(function(item){return item._id;});if(!products.length){_context.next=11;break;}_context.next=7;return addOrder({variables:{products:products}});case 7:_yield$addOrder=_context.sent;data=_yield$addOrder.data;productData=data.addOrder.products;productData.forEach(function(item){idbPromise('cart','delete',item);});case 11:setTimeout(function(){window.location.assign('/');},3000);case 12:case\"end\":return _context.stop();}}},_callee);}));return _saveOrder.apply(this,arguments);}saveOrder();},[addOrder]);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Jumbotron,null,/*#__PURE__*/React.createElement(\"h1\",null,\"Success!\"),/*#__PURE__*/React.createElement(\"h2\",null,\"Thank you for your purchase!\"),/*#__PURE__*/React.createElement(\"h2\",null,\"You will now be redirected to the home page\")));}export default Success;","map":{"version":3,"sources":["/Users/austinhague/Full_Stack_UofR/Projects/shop-shop-till-you-drop/client/src/pages/Success.js"],"names":["React","useEffect","useMutation","Jumbotron","ADD_ORDER","idbPromise","Success","addOrder","saveOrder","cart","products","map","item","_id","length","variables","data","productData","forEach","setTimeout","window","location","assign"],"mappings":"gkBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,WAAT,KAA4B,gBAA5B,CACA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CACA,OAASC,SAAT,KAA0B,oBAA1B,CACA,OAASC,UAAT,KAA2B,kBAA3B,CAEA,QAASC,CAAAA,OAAT,EAAmB,CACjB,iBAAmBJ,WAAW,CAACE,SAAD,CAA9B,8CAAOG,QAAP,kBAEAN,SAAS,CAAC,UAAM,SACCO,CAAAA,SADD,qIACd,4MACqBH,CAAAA,UAAU,CAAC,MAAD,CAAS,KAAT,CAD/B,QACQI,IADR,eAEQC,QAFR,CAEmBD,IAAI,CAACE,GAAL,CAAS,SAACC,IAAD,QAAUA,CAAAA,IAAI,CAACC,GAAf,EAAT,CAFnB,KAIMH,QAAQ,CAACI,MAJf,gDAK2BP,CAAAA,QAAQ,CAAC,CAAEQ,SAAS,CAAE,CAAEL,QAAQ,CAARA,QAAF,CAAb,CAAD,CALnC,sCAKYM,IALZ,iBAKYA,IALZ,CAMUC,WANV,CAMwBD,IAAI,CAACT,QAAL,CAAcG,QANtC,CAQIO,WAAW,CAACC,OAAZ,CAAoB,SAACN,IAAD,CAAU,CAC5BP,UAAU,CAAC,MAAD,CAAS,QAAT,CAAmBO,IAAnB,CAAV,CACD,CAFD,EARJ,QAaEO,UAAU,CAAC,UAAM,CACfC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,GAAvB,EACD,CAFS,CAEP,IAFO,CAAV,CAbF,uDADc,4CAmBdd,SAAS,GACV,CApBQ,CAoBN,CAACD,QAAD,CApBM,CAAT,CAsBA,mBACE,4CACE,oBAAC,SAAD,mBACE,yCADF,cAEE,6DAFF,cAGE,4EAHF,CADF,CADF,CASD,CAED,cAAeD,CAAAA,OAAf","sourcesContent":["import React, { useEffect } from 'react';\nimport { useMutation } from '@apollo/client';\nimport Jumbotron from '../components/Jumbotron';\nimport { ADD_ORDER } from '../utils/mutations';\nimport { idbPromise } from '../utils/helpers';\n\nfunction Success() {\n  const [addOrder] = useMutation(ADD_ORDER);\n\n  useEffect(() => {\n    async function saveOrder() {\n      const cart = await idbPromise('cart', 'get');\n      const products = cart.map((item) => item._id);\n\n      if (products.length) {\n        const { data } = await addOrder({ variables: { products } });\n        const productData = data.addOrder.products;\n\n        productData.forEach((item) => {\n          idbPromise('cart', 'delete', item);\n        });\n      }\n\n      setTimeout(() => {\n        window.location.assign('/');\n      }, 3000);\n    }\n\n    saveOrder();\n  }, [addOrder]);\n\n  return (\n    <div>\n      <Jumbotron>\n        <h1>Success!</h1>\n        <h2>Thank you for your purchase!</h2>\n        <h2>You will now be redirected to the home page</h2>\n      </Jumbotron>\n    </div>\n  );\n}\n\nexport default Success;\n"]},"metadata":{},"sourceType":"module"}